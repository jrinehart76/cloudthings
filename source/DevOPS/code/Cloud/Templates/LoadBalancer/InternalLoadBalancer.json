{
  "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "sku": {
      "type": "string",
      "defaultValue": "Standard",
      "metadata": {
        "description": "One to two word desc of what the ilb sits in front of, no spaces. Used in load balancer naming. Ex) FE for FrontEnd"
      },
      "allowedValues": [
        "Basic",
        "Standard"
      ]
    },
    "privateIPAllocationMethod": {
      "type": "string",
      "defaultValue": "Static",
      "metadata": {
        "description": "Dynamic or Static IP"
      },
      "allowedValues": [
        "Dynamic",
        "Static"
      ]
    },
    "privateIPAddress": {
      "type": "string",
      "defaultValue": "15.15.13.5",
      "metadata": {
        "description": "Internal Ip for the load balancer"
      }
    },

    "virtualNetworkRGName": {
      "type": "string",
      "defaultValue": "test-vnet02"
    },
    "virtualNetworkName": {
      "type": "string",
      "defaultValue": "test-vnet02"
    },
    "subnetName": {
      "type": "string",
      "defaultValue": "Subnet-AM-EastUS-Prod-CEPLATAM-AppGW"
    },
    "ilbPurpose": {
      "type": "string",
      "defaultValue": "FE",
      "metadata": {
        "description": "One to two word desc of what the ilb sits in front of, no spaces. Used in load balancer naming. Ex) FE for FrontEnd"
      }
    },
    "location": {
      "type": "string",
      "defaultValue": "EastUS",
      "metadata": {
        "description": "The Azure region for this deployment"
      }
    },
    "environment": {
      "type": "string",
      "defaultValue": "Dev",
      "metadata": {
        "description": "The abbreviated environment label"
      }
    },
    "application": {
      "type": "string",
      "defaultValue": "APP",
      "metadata": {
        "description": "The abbreviated application name"
      }
    },
    "region": {
      "type": "string",
      "defaultValue": "AM",
      "metadata": {
        "description": "The abbreviated Azure Region code"
      }
    }
  },
  "variables": {
    "subnetRef": "[concat(variables('vnetId'), '/subnets/', parameters('subnetName'))]",
    "baseNamingPrefix": "[concat(parameters('region'), '-',  parameters('location'), '-', parameters('environment'), '-', parameters('application'), parameters('ilbPurpose'))]",
    "loadBalancerName": "[concat('ILB-', variables('baseNamingPrefix'))]",
    "vnetId": "[resourceId(parameters('virtualNetworkRGName'),'Microsoft.Network/virtualNetworks', parameters('virtualNetworkName'))]"
  },
  "resources": [
    {
      "apiVersion": "2018-08-01",
      "name": "[variables('loadBalancerName')]",
      "type": "Microsoft.Network/loadBalancers",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('sku')]"
      },
      "dependsOn": [],
      "properties": {
        "frontendIPConfigurations": [
          {
            "name": "LoadBalancerFrontEnd",
            "properties": {
              "privateIPAllocationMethod": "[parameters('privateIPAllocationMethod')]",
              "subnet": {
                "id": "[variables('subnetRef')]"
              },
              "privateIPAddress": "[parameters('privateIPAddress')]"
            }
          }
        ]
      }
    }
  ]
}